<header id="main-header">
    <div class="logo-title-container">
        <a class="fiddle-logo" title="My Fiddle" [href]="getHomeUrl()">
            <img [ngStyle]="{display: getIsFiddleThemeDark() ? 'none' : ''}" [src]="'assets/logo.png'">
            <img [ngStyle]="{display: !getIsFiddleThemeDark() ? 'none' : ''}" [src]="'assets/logo_dark.png'">
        </a>
        <div class="fiddle-title">
            <input type="text" [(ngModel)]="fiddleTitle" class="form-control fiddle-input" (ngModelChange)="onFiddeTitleChange($event)" placeholder="Title"/>
            <div class="fiddle-size">
                <input type="number" [min]="0" class="width form-control" [(ngModel)]="iframeWidth" [disabled]="isFiddleWidthDisabled" (change)="onFiddeWidthChange($event.target.value)"/>
                <span class="x">x</span>
                <input type="number" [min]="0" class="height form-control" [(ngModel)]="iframeHeight" [disabled]="isFiddleHeightDisabled" (change)="onFiddeHeightChange($event.target.value)"/>
            </div>
        </div>        
    </div>

    <app-loader #loader class="app-loader"></app-loader>
    <div class="header-btns-container">
        <div class="themes-btn-container">
            <ul class="themes-menu" [ngClass]="{'shown': isThemesListShown}">
                <li *ngFor="let theme of getThemesList()" [ngClass]="{'selected': fiddleTheme.id == theme.id}" (click)="selectTheme(theme)">
                    {{theme.name}}
                </li>
            </ul>
            <button class="themes-btn btn" (click)="toggleThemesListMenu()">
                <span>Theme</span>
                <i *ngIf="!isThemesListShown" class="fa fa-sort-desc" aria-hidden="true"></i>
                <i *ngIf="isThemesListShown" class="fa fa-sort-asc" aria-hidden="true"></i>
            </button>
        </div>

        <div class="paypal-btn-container">
            <ul class="donations-menu" [ngClass]="{'shown': isDonationsListShown}">
                <li (click)="selectDonation(0)"><div><span>5</span><span>€</span></div></li>
                <li (click)="selectDonation(1)"><div><span>10</span><span>€</span></div></li>
                <li (click)="selectDonation(2)"><div><span>20</span><span>€</span></div></li>
                <li (click)="selectDonation(3)"><div><span>50</span><span>€</span></div></li>
            </ul>
            <button class="btn paypal-btn" (click)="toggleDonationMenu()" [ngClass]="{'on': isDonationsListShown, 'off': !isDonationsListShown}"><img class="paypal-icon" src="assets/paypal-icon.png"><i class="fa fa-sort-desc" *ngIf="!isDonationsListShown" aria-hidden="true"></i><i *ngIf="isDonationsListShown" class="fa fa-sort-asc" aria-hidden="true"></i></button>
        </div>
        <button class="ressources-code-btn btn" (click)="ressouresBtnClick()">
            <span>Resources</span>
        </button>
        <div class="layouts-list-container" (click)="toggleLayoutsList()" [ngClass]="{'shown': isLayoutsListShown, 'hidden': !isLayoutsListShown}">
            <button class="layouts-btn btn"><span>Layouts</span> <i class="fa fa-sort-desc" aria-hidden="true"></i><i class="fa fa-sort-asc" aria-hidden="true"></i>
            </button>
            <div class="layouts-list" #layoutsList>
                <div class="layout-1 layout" #layout1 (click)="changeLayout(1)" [ngClass]="{'active':(layout === 1)}">
                    <div>
                        <div>
                        </div>
                        <div>
                        </div>
                        <div>
                        </div>
                    </div>
                    <div>
                    </div>
                </div>
                <!---->
                <div class="layout-2 layout" #layout2  (click)="changeLayout(2)" [ngClass]="{'active':(layout === 2)}">
                    <div>
                        <div>
                        </div>
                        <div>
                        </div>
                        <div>
                        </div>
                    </div>
                    <div>
                    </div>
                </div>
                <!---->
                <div class="layout-3 layout" #layout3 (click)="changeLayout(3)" [ngClass]="{'active':(layout === 3)}">
                    <div>
                        <div>
                        </div>
                        <div>
                        </div>
                        <div>
                        </div>
                    </div>
                    <div>
                    </div>
                </div>
                <!---->
                <div class="layout-4 layout" #layout4  (click)="changeLayout(4)" [ngClass]="{'active':(layout === 4)}">
                    <div>
                        <div>
                        </div>
                        <div>
                        </div>
                        <div>
                        </div>
                    </div>
                    <div>
                    </div>
                </div>
            </div>
        </div>
        <button class="share-code-btn btn" (click)="runCode('save')">
            <span>Share</span>
        </button>
        <button class="share-code-btn btn" (click)="runCode()">
            <span>Run</span>
        </button>
    </div>
</header>
<div class="main-container" [ngClass]="'layout-type-'+layout" #mainContainer>
    <div id="code-parts-title-mobile">
        <a #htmlMobileToggle (click)="toggleCodePart('html')" [ngClass]="{'active':showHtml}">HTML</a>
        <a #cssMobileToggle (click)="toggleCodePart('css')" [ngClass]="{'active':showCss}">CSS</a>
        <a #jsMobileToggle (click)="toggleCodePart('js')" [ngClass]="{'active':showJs}">JS</a>
        <a #resultMobileToggle (click)="toggleCodePart('result')" [ngClass]="{'active':showResult}">Result</a>
    </div>
    
    <as-split [direction]="getLayoutInfos('outerAsSplitDirection')" [unit]="getLayoutInfos('outerAsSplitUnit')" #splitComponentOuter (dragEnd)="splitComponentOuterDragEnd($event)" (dragStart)="splitComponentOuterDragStart($event)" class="as-split-outer" [ngClass]="{'no-result-mobile': !showResult, 'no-code-mobile': !showHtml && !showCss && !showJs, 'is-dark-mode':getIsFiddleThemeDark()}" [gutterSize]="5">
            <as-split-area [order]="getLayoutInfos('codePartsAsSplitAreaOrder')" [minSize]="getLayoutInfos('codePartsAsSplitAreaMinSize')" [size]="getLayoutInfos('codePartsAsSplitAreaSize')" class="as-split-area-code-parts" [ngClass]="{'hide-mobile': !showHtml && !showCss && !showJs}">
                    <div id="code-parts" #codeParts>
                        <as-split [direction]="getLayoutInfos('innerAsSplitDirection')" [unit]="getLayoutInfos('innerAsSplitUnit')" #splitComponentInner (dragEnd)="splitComponentInnerDragEnd($event)" (dragStart)="splitComponentInnerDragStart($event)" [gutterSize]="5">
                            <as-split-area [minSize]="getLayoutInfos('emptyAsSplitAreaMinSize')" [size]="getLayoutInfos('emptyAsSplitAreaSize')" [maxSize]="getLayoutInfos('emptyAsSplitAreaMaxSize')" style="display: none"></as-split-area>
                            <as-split-area [minSize]="getLayoutInfos('htmlAsSplitAreaMinSize')" [size]="getLayoutInfos('htmlAsSplitAreaSize')" class="code-component-container code-component-container-html" 
                            [ngClass]="{'hide-mobile': !showHtml, 'fullscreen': isHtmlFullScreen, 'vertical-title-mode':getVerticalModeState('html')}">
                                <div class="code-part-title">
                                    <span>HTML</span>
                                    <div class="code-part-title-btns-container">

                                        <a class="html-stretch-btn code-part-title-btn" (click)="stretchCodePart('html',1)" [title]="'Stretch HTML'" [ngStyle]="{'padding': ((layout == 1 || layout == 3) ? '2px 5px' : ''), 'display': (isHtmlFullScreen ? 'none' : '')}" [ngClass]="{'vertical-title-mode':getVerticalModeState('html')}">
                                            <i *ngIf="layout == 1 || layout == 3" class="fa fa-arrows-v" aria-hidden="true"></i>
                                            <i *ngIf="layout == 2 || layout == 4" class="fa fa-arrows-h" aria-hidden="true"></i>
                                        </a>
                                        
                                        <a class="html-fullscreen-btn code-part-title-btn" (click)="toggleFullScreenMode('html')" [ngClass]="{'on':isHtmlFullScreen}" [title]="'Full screen HTML'">
                                            <i class="fa fa-arrows-alt" aria-hidden="true"></i>
                                        </a>
                                    </div>
                                </div>
                                <app-html-part (runcodemsg)="runCode()" (savecodemsg)="runCode('save')" #htmlPart class="code-component" [code]="htmlCode"></app-html-part>
                            </as-split-area>
                            <as-split-area [minSize]="getLayoutInfos('cssAsSplitAreaMinSize')" [size]="getLayoutInfos('cssAsSplitAreaSize')" class="code-component-container code-component-container-css"
                            [ngClass]="{'hide-mobile': !showCss, 'fullscreen': isCssFullScreen, 'vertical-title-mode':getVerticalModeState('css')}">
                                <div class="code-part-title">
                                    <span>CSS</span>
                                    <div class="code-part-title-btns-container">

                                        <a class="html-stretch-btn code-part-title-btn" (click)="stretchCodePart('css',2)" [title]="'Stretch CSS'" [ngStyle]="{'padding': (layout == 1 || layout == 3 ? '2px 5px' : ''), 'display': (isCssFullScreen ? 'none' : '')}" [ngClass]="{'vertical-title-mode':getVerticalModeState('css')}">
                                            <i *ngIf="layout == 1 || layout == 3" class="fa fa-arrows-v" aria-hidden="true"></i>
                                            <i *ngIf="layout == 2 || layout == 4" class="fa fa-arrows-h" aria-hidden="true"></i>
                                        </a>

                                        <a class="css-fullscreen-btn code-part-title-btn" (click)="toggleFullScreenMode('css')" [ngClass]="{'on':isCssFullScreen}" [title]="'Full screen CSS'">
                                            <i class="fa fa-arrows-alt" aria-hidden="true"></i>
                                        </a>
                                    </div>
                                </div>
                                <app-css-part (runcodemsg)="runCode()" (savecodemsg)="runCode('save')" #cssPart class="code-component" [code]="cssCode"></app-css-part>
                            </as-split-area>
                            <as-split-area [minSize]="getLayoutInfos('jsAsSplitAreaMinSize')" [size]="getLayoutInfos('jsAsSplitAreaSize')" class="code-component-container code-component-container-js" 
                            [ngClass]="{'hide-mobile': !showJs, 'fullscreen': isJsFullScreen, 'vertical-title-mode':getVerticalModeState('js')}">
                            <div class="code-part-title" >
                                    <span>JAVASCRIPT</span>
                                    <div class="code-part-title-btns-container">

                                        <a class="html-stretch-btn code-part-title-btn" (click)="stretchCodePart('js', 3)" [title]="'Stretch JAVASCRIPT'" [ngStyle]="{'padding': (layout == 1 || layout == 3 ? '2px 5px' : ''), 'display': (isJsFullScreen ? 'none' : '')}" [ngClass]="{'vertical-title-mode':getVerticalModeState('js')}">
                                            <i *ngIf="layout == 1 || layout == 3" class="fa fa-arrows-v" aria-hidden="true"></i>
                                            <i *ngIf="layout == 2 || layout == 4" class="fa fa-arrows-h" aria-hidden="true"></i>
                                        </a>

                                        <a class="js-fullscreen-btn code-part-title-btn" (click)="toggleFullScreenMode('js')" [ngClass]="{'on':isJsFullScreen}" [title]="'Full screen JS'">
                                            <i class="fa fa-arrows-alt" aria-hidden="true"></i>
                                        </a>
                                    </div>
                                </div>
                                <app-js-part (runcodemsg)="runCode()" (savecodemsg)="runCode('save')" #jsPart class="code-component" [code]="jsCode"></app-js-part>
                            </as-split-area>
                        </as-split>
                    </div>
            
            </as-split-area>
            <as-split-area [order]="getLayoutInfos('iframeAsSplitAreaOrder')" [minSize]="getLayoutInfos('iframeAsSplitAreaMinSize')" [size]="getLayoutInfos('iframeAsSplitAreaSize')" style="position:relative;" class="as-split-area-iframe" [ngClass]="{'hide-mobile': !showResult, 'is-vertical':(layout == 1) || (layout == 3), 'is-horizontal':(layout == 2) || (layout == 4)}">
                    <div class="iframe-menu"></div>
                    <div #emptyArea1 class="empty-area empty-area-1" [ngClass]="{'is-dark-mode':getIsFiddleThemeDark()}" [ngStyle]="{'flex':'0 0 '+getEmptyAreaSize(1)}">
                    </div>
                    <div #customGutter1 class="as-split-gutter-custom" [ngClass]="{'is-dark-mode':getIsFiddleThemeDark(), 'is-vertical':(layout == 1) || (layout == 3), 'is-horizontal':(layout == 2) || (layout == 4)}" (mousedown)="onGutterCustomMousedown($event,1)" (touchstart)="onGutterCustomMousedown($event,1)" >
                        <div class="as-split-gutter-icon-custom"></div>
                    </div>
                    <div class="iframe-hack" [ngStyle]="{'display' : showIframeHider ? '' : 'none' }">
                        <div class="fiddle-size fiddle-size-hack">
                            <span class="width">{{iframeWidth}}</span>
                            <span class="x">x</span>
                            <span class="height">{{iframeHeight}}</span>
                        </div>
                    </div>
                    <div class="iframe-area" [ngStyle]="{'flex':'0 0 '+getIframeAreaSize()}">
                        <div class="iframe-overlay" [ngStyle]="{'display': isCustomGutter1_dragging || isCustomGutter2_dragging ? 'block':''}"></div>
                        <app-iframe-part  #iframePart [ngClass]="{'hide-mobile': !showResult, 'layout-type-1': (layout == 1),       'layout-type-2': (layout == 2), 'layout-type-3': (layout == 3), 'layout-type-4': (layout == 4)}"  #iframePart   (hideloader)="onIframePartHideLoader()" (showloader)="onIframePartShowLoader()"></app-iframe-part>
                    </div>
                    <div class="as-split-gutter-custom" [ngClass]="{'is-dark-mode':getIsFiddleThemeDark(), 'is-vertical':(layout == 1) || (layout == 3), 'is-horizontal':(layout == 2) || (layout == 4)}" (mousedown)="onGutterCustomMousedown($event,2)" (touchstart)="onGutterCustomMousedown($event,2)" #customGutter2>
                        <div class="as-split-gutter-icon-custom"></div>
                    </div>
                    <div #emptyArea2 class="empty-area empty-area-2" [ngClass]="{'is-dark-mode':getIsFiddleThemeDark()}" [ngStyle]="{'flex':'0 0 '+getEmptyAreaSize(2)}">
                    </div>                   
            </as-split-area>
    </as-split>
    
</div>
<app-modal #modal>
    <div class="modal-header">
        <button class="modal-validate-btn btn" (click)="validateRessources()"><i class="fa fa-check" aria-hidden="true"></i></button>
        <h3>Fiddle resources</h3>
        <button class="modal-close-btn" (click)="hideModal()"><span>X</span></button>
    </div>
    <div class="modal-body">
        <app-ressources #ressources (hidemodal)="hideModal()" (validate)="onRessourcesValidate($event)"></app-ressources>
    </div>
    <div class="modal-footer" style="padding:0px;">
    </div>
</app-modal>